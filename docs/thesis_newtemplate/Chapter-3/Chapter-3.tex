\chapter{Curved mesh generation}
\section{Introduction}
With the rising popularity of high-order computational methods in the aerospace community, robust techniques to obtain a high-order representation of the boundary have become important. One such technique is to produce high-order meshes, otherwise called curvilinear or curved meshes. Another technique in this regard is isogeometric analysis \cite{isogeometric} where CAD data is directly used in analysis. In this work, we deal with curved unstructured mesh generation, using only the linear mesh data.

The problem of curved mesh generation involves at least one issue - the placement of the boundary ``high-order" nodes. Some kind of description of a high-order boundary is required, and the optimal placement of high-order boundary nodes must be decided.

Additionally, we usually need to deal with one more issue - maintaining the quality of elements near the boundary after placing the high-order boundary nodes. The deformation of the initially polygonal/polyhedral boundary to get a curved boundary usually causes the quality of boundary elements to get reduced. In cases with a viscous mesh, these elements may even become invalid \cite{curve:persson, gmsh:untangling}. Thus, the deformation of the boundary must be propagated into the domain, to displace interior nodes upto at least some distance from the boundary.

In our knowledge, there are, broadly speaking, three types of methods to achieve movement of the interior nodes. The first type uses models based on solid mechanics to try to achieve valid mesh movement. Examples of this type are lineal spring analogy \cite{mm:batina}, torsion spring analogy \cite{mm:torsionsprings}, linear-elasticity (and variants thereof)\cite{curve:hartmann} and non-linear elasticity \cite{curve:persson}. Each of these requires solution of a system of equations involving the same number of variables as mesh points to be moved. The linear-elasticity based models require solution of Poisson-type partial differential equations.

The second type of technique to move the interior nodes involves \emph{interpolation} of the boundary displacement to interior nodes. Several methods exist; some examples are radial basis function (RBF) interpolation \cite{mm:rbf}, `explicit' interpolation \cite{mm:explicit}, and `Delaunay graph mapping' \cite{mm:dgm}. These methods do not involve any physics-based modeling of the mesh.

Finally, researchers have ``untangled" the near-boundary elements, and otherwise improved the quality of the mesh, by optimization processes. The cost function is some kind of curved-mesh quality measure. One prominent example of this is in the Gmsh meshing software \cite{gmsh:untangling}.

We have tried several methods from the solid mechanics and interpolation classes of mesh-movement methods. Here, we mainly discuss the RBF method and linear elasticity.

In the rest of the sections, we discuss the methodology used to generate 2D unstructured quadratic meshes using only the linear mesh, and then present examples to demonstrate the effectiveness of our method. We also compare the quality of meshes given by the RBF interpolation method and the linear-elasticity method.

\section{Method}

We initially preprocess the linear mesh to generate a straight-faceted high-order mesh. To do this for 2D meshes, we place extra nodes at equally-spaced positions in each facet (edge in case of 2D) of the mesh, and if required, extra nodes are also placed within the elements. Nodes of this intermediate mesh are later displaced to obtain the curved mesh. For a 2D quadratic mesh made up of triangular elements, we need a high-order node at the midpoint of every edge.

Since only the linear mesh is taken as input, a high-order boundary representation first needs to be reconstructed from the piecewise linear $\mathbf{C}^0$ boundary. For 2D meshes, we use a cubic spline reconstruction to get a smooth ($\mathbf{C}^2$) parametric curve describing the boundary. All boundary nodes are used as spline control points, and we get a cubic function between every two consecutive boundary nodes. At the control points, we require the two spline curves meeting there to share a common tangent and curvature, thus enforcing $\mathbf{C}^2$ continuity. Corners are detected by comparing the normal vectors of the two facets sharing a point. If the dot product between the two normal vectors is below a particular threshold, the point is considered as a corner and is not smoothed over by the reconstruction procedure. Alternatively, the user can list all the corner points as input. The spline reconstruction requires the solution of a symmetric positive definite linear system, of size equal to the number of boundary nodes in the curved part of the boundary, in order to calculate the cubic spline coefficients. The system(s) can be solved quickly using a conjugate gradient (CG) solver.

Once we have the smooth reconstructed boundary, we calculate the final positions of the boundary nodes in the curved mesh. This is currently done by simply moving the high-order boundary nodes, originally at regular intervals on the boundary facet, to corresponding intervals in parameter space on the cubic spline curve associated with that facet. This method is found to be quite robust for the meshes tested. Thus, the boundary displacements are obtained.

To propagate the boundary motion to the interior of the mesh, we favor interpolation by radial basis functions (RBFs) \cite{mm:rbf}. We have also used linear elasticity to propagate the mesh movement to the interior. The isotropic linear elasticity variational formulation, as given by Gockenbach \cite{gockenbach}, is implemented in a P2 Galerkin FEM code for generation of quadratic meshes. In this case however, the size of the linear system to be solved is proportional to the total number of nodes in the mesh.

Though the RBF method requires the solution of a linear system of size proportional to only the number of boundary points, extra computation is required to evaluate equation \eqref{eqn:rbf} at each of the interior nodes to compute their displacements. In comparison, elasticity-based methods directly give us the displacements.


